(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18422,        360]
NotebookOptionsPosition[     17763,        340]
NotebookOutlinePosition[     18239,        358]
CellTagsIndexPosition[     18196,        355]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<draw.m\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<checkAnswer.m\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<test.m\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modalita", " ", "=", 
    RowBox[{"Input", "[", "\"\<Inserisci modalit\[AGrave]\>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"outputbanco", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"outputgiocatore", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"outputavversari", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"cardrequest", "=", "\"\<\>\""}], ",", 
      RowBox[{"rightprob", "=", " ", "0"}], ",", 
      RowBox[{"text", "=", "\"\<\>\""}], ",", 
      RowBox[{"result", "=", "\"\<\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "outputbanco", ",", "outputgiocatore", ",", "outputavversari", ",", 
        " ", "cardrequest", ",", "rightprob"}], "}"}], "=", 
      RowBox[{"draw`DrawAll", "[", "modalita", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"answer", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"modalita", ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{"richiesta", " ", "=", 
        RowBox[{
        "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare una coppia di \
\>\"", " ", "<>", "cardrequest", "<>", " ", 
         "\"\< estraendo la prossima carta dal mazzo?\>\""}]}], ",", 
       "\[IndentingNewLine]", "2", ",", " ", 
       RowBox[{"richiesta", " ", "=", 
        RowBox[{
        "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare un tris di \>\"", 
         " ", "<>", "cardrequest", "<>", " ", 
         "\"\< estraendo le prossime 2 carte dal mazzo?\>\""}]}], ",", 
       "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{"richiesta", " ", "=", 
        RowBox[{
        "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare una coppia di \
\>\"", " ", "<>", "cardrequest", "<>", " ", 
         "\"\< estraendo le prossime 2 carte dal mazzo?\>\""}]}], ",", 
       "\[IndentingNewLine]", "_", ",", " ", "\"\<Errore\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"modalita", ">", "3"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", "outputavversari", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Dynamic", "[", "outputbanco", "]"}], ",", " ", 
        RowBox[{"Dynamic", "[", "outputgiocatore", "]"}], ",", "\"\< \>\"", 
        ",", " ", 
        RowBox[{"Dynamic", "[", "richiesta", "]"}], ",", "\"\< \>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "text", "]"}], ",", "String"}], "]"}], 
           ",", "\"\< \>\"", ",", " ", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Verifica Risultato\>\"", ",", 
             RowBox[{
              RowBox[{"answer", "=", 
               RowBox[{"ToExpression", "[", "text", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"result", "=", 
               RowBox[{"checkAnswer`checkAnswer", "[", 
                RowBox[{"answer", ",", "rightprob", ",", "modalita"}], 
                "]"}]}], ";"}]}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "result", "}"}], "]"}]}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Nuovo esercizio\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "outputbanco", ",", "outputgiocatore", ",", "outputavversari", 
              ",", " ", "cardrequest", ",", "rightprob"}], "}"}], "=", 
            RowBox[{"draw`DrawAll", "[", "modalita", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"result", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{"text", " ", "=", " ", "\"\<\>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"modalita", ",", "\[IndentingNewLine]", "1", ",", 
             RowBox[{"richiesta", " ", "=", 
              RowBox[{
              "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare una coppia \
di \>\"", " ", "<>", "cardrequest", "<>", " ", 
               "\"\< estraendo la prossima carta dal mazzo?\>\""}]}], ",", 
             "\[IndentingNewLine]", "2", ",", " ", 
             RowBox[{"richiesta", " ", "=", 
              RowBox[{
              "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare un tris di \
\>\"", " ", "<>", "cardrequest", "<>", " ", 
               "\"\< estraendo le prossime 2 carte dal mazzo?\>\""}]}], ",", 
             "\[IndentingNewLine]", "3", ",", " ", 
             RowBox[{"richiesta", " ", "=", 
              RowBox[{
              "\"\<Qual \[EGrave] la probabilit\[AGrave] di fare una coppia \
di \>\"", " ", "<>", "cardrequest", "<>", " ", 
               "\"\< estraendo le prossime 2 carte dal mazzo?\>\""}]}], ",", 
             "\[IndentingNewLine]", "_", ",", " ", "\"\<Errore\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.892019833969627*^9, 3.892019833969627*^9}, {
   3.892019866751369*^9, 3.8920199140382833`*^9}, {3.8920208880056105`*^9, 
   3.8920208941386414`*^9}, {3.892021093092636*^9, 3.8920211932166743`*^9}, {
   3.892021358243782*^9, 3.8920213836592236`*^9}, {3.892021634685559*^9, 
   3.8920216602836423`*^9}, {3.892021787787074*^9, 3.8920218236338863`*^9}, 
   3.8920218552691097`*^9, {3.892022328094736*^9, 3.8920223435805063`*^9}, {
   3.8920223782810707`*^9, 3.8920224658198786`*^9}, {3.8920225093568487`*^9, 
   3.892022564217703*^9}, {3.892022604923787*^9, 3.8920226417813177`*^9}, {
   3.8920226853046117`*^9, 3.8920226912440176`*^9}, {3.892022770416397*^9, 
   3.892022776004442*^9}, {3.8920228150518637`*^9, 3.8920228172361507`*^9}, 
   3.8920228784598627`*^9, {3.892022965362941*^9, 3.892022971448085*^9}, {
   3.8920230086930227`*^9, 3.8920230104954157`*^9}, {3.8920232676929455`*^9, 
   3.8920232782249823`*^9}, {3.8920233355740433`*^9, 3.892023407896145*^9}, {
   3.8920234521061673`*^9, 3.892023464092931*^9}, {3.892023536163212*^9, 
   3.8920235767370505`*^9}, {3.8920236086608987`*^9, 
   3.8920236533753557`*^9}, {3.8920239364500504`*^9, 3.892023939030896*^9}, {
   3.8920240031570826`*^9, 3.8920240088991165`*^9}, {3.892024046683764*^9, 
   3.892024053452534*^9}, {3.892024085091322*^9, 3.892024111603029*^9}, {
   3.8920241728379555`*^9, 3.8920241730481234`*^9}, {3.8920242610008917`*^9, 
   3.8920242674953814`*^9}, {3.892024304631721*^9, 3.892024322116329*^9}, {
   3.892024454348444*^9, 3.8920244818178625`*^9}, {3.8920245839554186`*^9, 
   3.892024586936367*^9}, {3.892090332030015*^9, 3.8920903566727247`*^9}, {
   3.8920904006571894`*^9, 3.892090401251741*^9}, {3.8920905126641984`*^9, 
   3.8920905190050983`*^9}, {3.8920905680112767`*^9, 3.892090569960533*^9}, {
   3.892090600179474*^9, 3.8920906098524704`*^9}, {3.8920906570158467`*^9, 
   3.892090660283854*^9}, {3.8920907498409605`*^9, 3.892090755073594*^9}, {
   3.8920908464914804`*^9, 3.8920908698945904`*^9}, {3.892090921217837*^9, 
   3.892090922317938*^9}, 3.8920910902375507`*^9, {3.89209129776497*^9, 
   3.8920913084075174`*^9}, 3.892091565636097*^9, 3.8920916015485945`*^9, {
   3.892091666590763*^9, 3.8920917469360085`*^9}, {3.8920918210385513`*^9, 
   3.8920918351177773`*^9}, 3.892091930921177*^9, 3.892091969753805*^9, {
   3.892092006772156*^9, 3.8920920231580143`*^9}, 3.8920921738620567`*^9, {
   3.892092296292973*^9, 3.8920922989981737`*^9}, {3.892092411598526*^9, 
   3.892092478002638*^9}, {3.892092523933181*^9, 3.892092553086897*^9}, {
   3.892092812307135*^9, 3.8920928146489096`*^9}, {3.892093182869735*^9, 
   3.8920931887797723`*^9}, {3.892093223854495*^9, 3.892093231855702*^9}, {
   3.8920933877233553`*^9, 3.8920934449148846`*^9}, {3.892093582489232*^9, 
   3.8920937203084283`*^9}, {3.892093768058925*^9, 3.892093897623706*^9}, {
   3.8920939507850075`*^9, 3.892093957465146*^9}, 3.892093993035884*^9, {
   3.892094043729922*^9, 3.892094045232605*^9}, {3.8920946138090568`*^9, 
   3.892094644543105*^9}, 3.892094723770367*^9, {3.8920947993051972`*^9, 
   3.892094826292046*^9}, {3.8920997913704314`*^9, 3.8920998063213263`*^9}, {
   3.892099843357394*^9, 3.892099854842617*^9}, {3.892099919355197*^9, 
   3.892099972484212*^9}, {3.8921000276728344`*^9, 3.8921000280580006`*^9}, {
   3.892100078186313*^9, 3.8921000860284133`*^9}, {3.892100168953616*^9, 
   3.89210019680646*^9}, {3.8921002495876493`*^9, 3.892100253398919*^9}, {
   3.8921003860641108`*^9, 3.8921004633254747`*^9}, {3.89210060053824*^9, 
   3.892100672273541*^9}, {3.8921014155324335`*^9, 3.8921014448779926`*^9}, {
   3.892101561132732*^9, 3.892101581167415*^9}, 3.8921016203921847`*^9, {
   3.8921016626705046`*^9, 3.8921016977860384`*^9}, {3.8921021278412824`*^9, 
   3.892102145755869*^9}, {3.8921022893746004`*^9, 3.892102352629236*^9}, {
   3.892102405071749*^9, 3.892102409442243*^9}, {3.892230572214721*^9, 
   3.8922306178257875`*^9}, {3.892267256874005*^9, 3.8922672576520085`*^9}, {
   3.8922674241062737`*^9, 3.8922674858815565`*^9}, 3.8922676628228846`*^9, {
   3.892267695843415*^9, 3.892267735212867*^9}, {3.8922677653101287`*^9, 
   3.892267769951002*^9}, 3.8922678782106075`*^9, {3.8922679521741934`*^9, 
   3.8922679574797554`*^9}, {3.8922680086091843`*^9, 3.892268040694422*^9}, {
   3.8922680987359695`*^9, 3.89226810899833*^9}, {3.8922681824492273`*^9, 
   3.8922682078069935`*^9}, {3.8922682404994392`*^9, 3.892268290087397*^9}, {
   3.892268373752127*^9, 3.8922684343616433`*^9}, {3.892268569241434*^9, 
   3.892268632238164*^9}, {3.892268817216711*^9, 3.892268820263938*^9}, {
   3.892268924065689*^9, 3.8922689293120117`*^9}, {3.892269013839202*^9, 
   3.892269031631696*^9}, {3.8922699956427608`*^9, 3.8922700753531103`*^9}, {
   3.8922701782967625`*^9, 3.8922702040206976`*^9}, {3.892270298311754*^9, 
   3.892270328436699*^9}, {3.89227044119886*^9, 3.8922704701976633`*^9}, {
   3.8922709239562073`*^9, 3.8922709579932103`*^9}, {3.8922710466613884`*^9, 
   3.892271048595749*^9}, {3.892271079020377*^9, 3.892271099144888*^9}, {
   3.892271252207739*^9, 3.8922713583735437`*^9}, 3.8922714217162886`*^9, {
   3.8922719994780407`*^9, 3.8922720009833374`*^9}, {3.892272079691287*^9, 
   3.892272128417594*^9}, 3.892272159077427*^9, 3.8922723094753056`*^9, {
   3.8922725438708324`*^9, 3.8922726194596443`*^9}, {3.8922726603392696`*^9, 
   3.892272662256039*^9}, {3.8922727177717867`*^9, 3.8922727187539487`*^9}, {
   3.892273079106778*^9, 3.8922731541947217`*^9}, {3.8922732360542717`*^9, 
   3.892273267096239*^9}, {3.89227330722087*^9, 3.8922733603192368`*^9}, {
   3.8922734317680516`*^9, 3.8922734347076473`*^9}, {3.8922735002149367`*^9, 
   3.8922735282017603`*^9}, {3.8922736278032646`*^9, 
   3.8922736383792334`*^9}, {3.892273795785557*^9, 3.8922738403272696`*^9}, {
   3.8922738754184504`*^9, 3.8922738776942267`*^9}, {3.8922739637750983`*^9, 
   3.892274010225418*^9}, {3.892274101473177*^9, 3.8922741110192747`*^9}, {
   3.8922741503280573`*^9, 3.892274150659732*^9}, {3.89227444833051*^9, 
   3.892274454458109*^9}, {3.892274672847451*^9, 3.892274693529814*^9}, {
   3.892274742763073*^9, 3.8922748099906197`*^9}, {3.892274851562688*^9, 
   3.8922748517799296`*^9}, {3.892274922104834*^9, 3.892275035410308*^9}, {
   3.8922751615363398`*^9, 3.8922751689154344`*^9}, {3.8922752534899893`*^9, 
   3.8922752573578625`*^9}, {3.892275411449212*^9, 3.892275438293519*^9}, {
   3.8922754711764584`*^9, 3.892275534588107*^9}, {3.8922755871137056`*^9, 
   3.892275663779994*^9}, 3.892275823491729*^9, {3.8922766104162245`*^9, 
   3.892276612990105*^9}, {3.892279260500584*^9, 3.8922792698285637`*^9}, {
   3.8922793952692556`*^9, 3.892279397356845*^9}, {3.892279457767231*^9, 
   3.8922794634895353`*^9}, {3.8922815408955727`*^9, 
   3.8922815440379143`*^9}, {3.8922818388507013`*^9, 3.892281843040122*^9}, 
   3.8922818799670796`*^9, {3.8922847077405415`*^9, 3.892284710965766*^9}, {
   3.8922857857677455`*^9, 3.892285794833686*^9}, {3.892620439186969*^9, 
   3.8926204928613415`*^9}, {3.892620584697674*^9, 3.8926205914854136`*^9}, {
   3.8926208553210363`*^9, 3.892620908567441*^9}, {3.892620958474743*^9, 
   3.892620978793783*^9}, {3.8926210361027164`*^9, 3.8926210385993285`*^9}, {
   3.892621095357606*^9, 3.892621142109782*^9}, {3.892624498766179*^9, 
   3.8926245000190125`*^9}, {3.8926245424356403`*^9, 3.892624580354271*^9}, {
   3.8926247496177974`*^9, 3.8926247533591022`*^9}, {3.8926249545912375`*^9, 
   3.892624957686633*^9}},ExpressionUUID->"1ece7017-d0a5-4405-8be7-\
fb36d1a4acd1"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"outputbanco$4809\\\", \
\\\",\\\", \\\"outputgiocatore$4809\\\", \\\",\\\", \
\\\"outputavversari$4809\\\", \\\",\\\", \\\"cardrequest$4809\\\", \\\",\\\", \
\\\"rightprob$4809\\\"}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"DrawAll\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}]\\) are \
not the same shape.\"", 2, 6, 1, 18559235211299254424, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.892624704335966*^9, 3.892624786677289*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"f0a2d48e-5e05-42ec-9bf4-763bacaa5156"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`outputbanco$$ = {}, \
$CellContext`outputgiocatore$$ = {}, $CellContext`outputavversari$$ = {}, \
$CellContext`cardrequest$$ = "", $CellContext`rightprob$$ = 
  0, $CellContext`text$$ = "", $CellContext`result$$ = ""}, 
  TagBox[GridBox[{
     {""},
     {
      DynamicBox[ToBoxes[$CellContext`outputbanco$$, StandardForm],
       ImageSizeCache->{
        17.16279373168945, {2.646337961219251, 8.937500238418579}}]},
     {
      DynamicBox[ToBoxes[$CellContext`outputgiocatore$$, StandardForm],
       ImageSizeCache->{
        17.16279373168945, {2.646337961219251, 8.937500238418579}}]},
     {"\<\" \"\>"},
     {
      DynamicBox[ToBoxes[$CellContext`richiesta, StandardForm],
       ImageSizeCache->{652.5631994247435, {3., 10.}}]},
     {"\<\" \"\>"},
     {
      TemplateBox[{
        InputFieldBox[
         Dynamic[$CellContext`text$$], String], "\" \"", 
        ButtonBox[
        "\"Verifica Risultato\"", 
         ButtonFunction :> ($CellContext`answer = 
           ToExpression[$CellContext`text$$]; $CellContext`result$$ = 
           checkAnswer`checkAnswer[$CellContext`answer, \
$CellContext`rightprob$$, $CellContext`modalita]; Null), Appearance -> 
         Automatic, Evaluator -> Automatic, Method -> "Preemptive"], "\" \"", 
        
        DynamicBox[
         ToBoxes[
          Row[{$CellContext`result$$}], StandardForm]]},
       "RowDefault"]},
     {
      ButtonBox["\<\"Nuovo esercizio\"\>",
       Appearance->Automatic,
       ButtonFunction:>({$CellContext`outputbanco$$, \
$CellContext`outputgiocatore$$, $CellContext`outputavversari$$, \
$CellContext`cardrequest$$, $CellContext`rightprob$$} = 
         draw`DrawAll[$CellContext`modalita]; $CellContext`result$$ = ""; 
        Switch[$CellContext`modalita, 1, $CellContext`richiesta = 
          "Qual \[EGrave] la probabilit\[AGrave] di fare una coppia di " <> \
$CellContext`cardrequest$$ <> " estraendo la prossima carta dal mazzo?", 
          2, $CellContext`richiesta = 
          "Qual \[EGrave] la probabilit\[AGrave] di fare un tris di " <> \
$CellContext`cardrequest$$ <> " estraendo le prossime 2 carte dal mazzo?", 
          3, $CellContext`richiesta = 
          "Qual \[EGrave] la probabilit\[AGrave] di fare una coppia di " <> \
$CellContext`cardrequest$$ <> " estraendo le prossime 2 carte dal mazzo?", 
          Blank[], "Errore"]; Null),
       Evaluator->Automatic,
       Method->"Preemptive"]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.8926213628714037`*^9, 3.8926213785931168`*^9}, 
   3.8926232101463957`*^9, 3.892623646736834*^9, {3.8926237117159443`*^9, 
   3.892623751878607*^9}, 3.892624133393178*^9, 3.8926247043814507`*^9, 
   3.892624786705246*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"eac1ad10-2df2-4731-9c08-0733a1b63aaf"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.1 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"609eb811-3a56-4477-9fdb-28876e746b6e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 13510, 233, 765, "Input",ExpressionUUID->"1ece7017-d0a5-4405-8be7-fb36d1a4acd1"],
Cell[14093, 257, 655, 13, 30, "Message",ExpressionUUID->"f0a2d48e-5e05-42ec-9bf4-763bacaa5156"],
Cell[14751, 272, 2996, 65, 187, "Output",ExpressionUUID->"eac1ad10-2df2-4731-9c08-0733a1b63aaf"]
}, Open  ]]
}
]
*)

